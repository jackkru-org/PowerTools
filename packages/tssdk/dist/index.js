(()=>{"use strict";var t={778:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.chainConfig=e.config=void 0;var r=n(354);e.config={requestTotalAttempts:5,callbackCallDelay:900,chainRequestTimeout:5e3,maxNodeResponseTime:99999},e.chainConfig={102:(0,r.transformNodeList)({"2UYKF1HyNz7QSFTGY5ffZSG8oWem":{host:["http://c102n6.thepower.io:43382","https://c102n6.thepower.io:43482"],ip:["http://c102n6.thepower.io:43382","https://c102n6.thepower.io:43482"]},"2i6tWT8XuT3jQcvpzKUM9V51L2sm":{host:["http://c102n7.thepower.io:43382","https://c102n7.thepower.io:43482"],ip:["http://c102n7.thepower.io:43382","https://c102n7.thepower.io:43482"]},"3UvkSW1iMARXVpxAwLRXppVJ5xNJ":{host:["http://c102n2.thepower.io:43382","https://c102n2.thepower.io:43482"],ip:["http://c102n2.thepower.io:43382","https://c102n2.thepower.io:43482"]},"4ChWotb5pfLvmGXBc5M8fu7jNHXB":{host:["http://c102n4.thepower.io:43382","https://c102n4.thepower.io:43482"],ip:["http://c102n4.thepower.io:43382","https://c102n4.thepower.io:43482"]},"4NoNQJzEcWr2gyszSUdGShXXseaC":{host:["http://c102n5.thepower.io:43382","https://c102n5.thepower.io:43482"],ip:["http://c102n5.thepower.io:43382","https://c102n5.thepower.io:43482"]},NPvVcKpnHuGKsActjmEmWKgSbZh:{host:["http://c102n9.thepower.io:43382","https://c102n9.thepower.io:43482"],ip:["http://c102n9.thepower.io:43382","https://c102n9.thepower.io:43482"]},oM2yj49e3g3gWquE1x1JDfa8ZQD:{host:["http://c102n3.thepower.io:43382","https://c102n3.thepower.io:43482"],ip:["http://c102n3.thepower.io:43382","https://c102n3.thepower.io:43482"]},wFQYUgQLa2yJqdEgVD7sJLJxewC:{host:["http://c102n10.thepower.io:43382","https://c102n10.thepower.io:43482"],ip:["http://c102n10.thepower.io:43382","https://c102n10.thepower.io:43482"]}}),8:(0,r.transformNodeList)({"8rxo4eAncEqj8kraFFmS9MvJTGW":{host:["http://c8n1.thepower.io:43288","https://c8n1.thepower.io:43388"],ip:["http://51.15.80.38:43288","https://51.15.80.38:43388"]}}),2:(0,r.transformNodeList)({"2UYKF1HyNz7QSFTGY5ffZSG8oWem":{host:["http://c102n6.thepower.io:43382","https://c102n6.thepower.io:43482"],ip:["http://c102n6.thepower.io:43382","https://c102n6.thepower.io:43482"]},"2i6tWT8XuT3jQcvpzKUM9V51L2sm":{host:["http://c102n7.thepower.io:43382","https://c102n7.thepower.io:43482"],ip:["http://c102n7.thepower.io:43382","https://c102n7.thepower.io:43482"]},"3UvkSW1iMARXVpxAwLRXppVJ5xNJ":{host:["http://c102n2.thepower.io:43382","https://c102n2.thepower.io:43482"],ip:["http://c102n2.thepower.io:43382","https://c102n2.thepower.io:43482"]},"4ChWotb5pfLvmGXBc5M8fu7jNHXB":{host:["http://c102n4.thepower.io:43382","https://c102n4.thepower.io:43482"],ip:["http://c102n4.thepower.io:43382","https://c102n4.thepower.io:43482"]},"4NoNQJzEcWr2gyszSUdGShXXseaC":{host:["http://c102n5.thepower.io:43382","https://c102n5.thepower.io:43482"],ip:["http://c102n5.thepower.io:43382","https://c102n5.thepower.io:43482"]},oM2yj49e3g3gWquE1x1JDfa8ZQD:{host:["http://c102n3.thepower.io:43382","https://c102n3.thepower.io:43482"],ip:["http://c102n3.thepower.io:43382","https://c102n3.thepower.io:43482"]},wFQYUgQLa2yJqdEgVD7sJLJxewC:{host:["http://c102n10.thepower.io:43382","https://c102n10.thepower.io:43482"],ip:["http://c102n10.thepower.io:43382","https://c102n10.thepower.io:43482"]}})}},14:(t,e)=>{var n;Object.defineProperty(e,"__esModule",{value:!0}),e.ChainAction=void 0,(n=e.ChainAction||(e.ChainAction={})).GET_TRANSACTION_STATUS="GET_TRANSACTION_STATUS",n.GET_CHAIN_NODES="GET_CHAIN_NODES",n.GET_BLOCK="GET_BLOCK",n.GET_WALLET="GET_WALLET",n.GET_NODE_SETTINGS="GET_NODE_SETTINGS",n.CREATE_TRANSACTION="CREATE_TRANSACTION",n.GET_MY_CHAIN="GET_MY_CHAIN",n.GET_SC_CODE="GET_SC_CODE",n.GET_SC_STATE="GET_SC_STATE"},354:function(t,e,n){var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{a(r.next(t))}catch(t){i(t)}}function c(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,c)}a((r=r.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},s=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},c=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.transformResponse=e.transformNodeList=e.queueNodes=void 0;var a=c(n(167)),h=n(14),u=n(778);e.queueNodes=function(t){return r(void 0,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return e=+new Date,[4,Promise.all(t.map((function(t){return a.default.request({url:"".concat(t.address,"/api/status"),timeout:1e3,params:{node:t.nodeId}}).then((function(t){return{address:new URL(t.config.url).origin,time:+new Date-e,nodeId:t.config.node}}),(function(t){return{address:new URL(t.config.url).origin,time:u.config.maxNodeResponseTime,nodeId:t.config.node}}))})))];case 1:return[2,n.sent().sort((function(t,e){return(t.time||0)-(e.time||0)}))]}}))}))},e.transformNodeList=function(t){var e=[];return Object.keys(t).forEach((function(n){t[n].ip.forEach((function(t){return e.push({address:t,nodeId:n})})),t[n].host.forEach((function(t){return e.push({address:t,nodeId:n})}))})),e.reduce((function(t,e){var n=e.address,r=e.nodeId;return t.some((function(t){return t.address===n&&t.nodeId===r}))?t:s(s([],i(t),!1),[{address:n,nodeId:r}],!1)}),[])},e.transformResponse=function(t,n){return r(void 0,void 0,void 0,(function(){return o(this,(function(r){switch(n){case h.ChainAction.GET_TRANSACTION_STATUS:return[2,t.res];case h.ChainAction.GET_CHAIN_NODES:return[2,(0,e.transformNodeList)(t.chain_nodes)];case h.ChainAction.GET_BLOCK:return[2,t.block];case h.ChainAction.GET_WALLET:return[2,t.info];case h.ChainAction.GET_NODE_SETTINGS:return[2,t.settings]}return[2,t]}))}))}},115:function(t,e,n){var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{a(r.next(t))}catch(t){i(t)}}function c(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,c)}a((r=r.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Network=void 0;var c=s(n(167)),a=s(n(999)),h=n(778),u=n(354),p=n(14),d=(0,s(n(974)).default)("info"),f=function(){function t(t){var e=this;this.currentChain="",this.currentNodes=[],this.nodeIndex=0,this.setCurrentConfig=function(t){return r(e,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return e=this,[4,(0,u.queueNodes)(t)];case 1:return e.currentNodes=n.sent(),this.nodeIndex=0,[2]}}))}))},this.getBlock=function(t){return void 0===t&&(t="last"),r(e,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,this.askBlockchainTo(p.ChainAction.GET_BLOCK,{chain:this.currentChain,hash:t})];case 1:return[2,e.sent()]}}))}))},this.getWallet=function(t){return r(e,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,this.askBlockchainTo(p.ChainAction.GET_WALLET,{chain:this.currentChain,address:t})];case 1:return[2,e.sent()]}}))}))},this.loadScCode=function(t){return r(e,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return e=Uint8Array.bind,[4,this.askBlockchainTo(p.ChainAction.GET_SC_CODE,{chain:this.currentChain,address:t})];case 1:return[2,new(e.apply(Uint8Array,[void 0,n.sent()]))]}}))}))},this.loadScState=function(t){return r(e,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return e=Uint8Array.bind,[4,this.askBlockchainTo(p.ChainAction.GET_SC_STATE,{chain:this.currentChain,address:t})];case 1:return[2,new(e.apply(Uint8Array,[void 0,n.sent()]))]}}))}))},this.bootstrap=function(){return r(e,void 0,void 0,(function(){var t,e;return o(this,(function(n){switch(n.label){case 0:return[4,this.getChainInfo()];case 1:if(!(t=n.sent())[this.currentChain])return[3,3];if(!(e=t[this.currentChain]).length)throw new Error("No nodes found for chain ".concat(this.currentChain));return[4,this.setCurrentConfig(e)];case 2:return n.sent(),d("Bootstrapped chain ".concat(this.currentChain),this.currentNodes),[2];case 3:throw new Error("Unknown chain ".concat(this.currentChain))}}))}))},this.checkTransaction=function(t,n,i,s){return void 0===s&&(s=0),r(e,void 0,void 0,(function(){var e,r=this;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.askBlockchainTo(p.ChainAction.GET_TRANSACTION_STATUS,{txId:t})];case 1:return e=o.sent(),[3,3];case 2:return o.sent(),n(!1,"Network error"),[3,3];case 3:return e?n(!e.error,"".concat(t,": ").concat(e.res)):s<i?setTimeout((function(){return r.checkTransaction(t,n,i,++s)}),h.config.callbackCallDelay):n(!1,"".concat(t,": Transaction status lost")),[2]}}))}))},this.incrementNodeIndex=function(){return r(e,void 0,void 0,(function(){var t;return o(this,(function(e){switch(e.label){case 0:return this.nodeIndex++,this.nodeIndex>=this.currentNodes.length||this.currentNodes[this.nodeIndex].time===h.config.maxNodeResponseTime?(t=this,[4,(0,u.queueNodes)(this.currentNodes)]):[3,2];case 1:if(t.currentNodes=e.sent(),this.nodeIndex=0,this.nodeIndex>=this.currentNodes.length||this.currentNodes[this.nodeIndex].time===h.config.maxNodeResponseTime)throw new Error("Chain unavailable.");e.label=2;case 2:return[2]}}))}))},this.httpRequest=function(t,n){return r(e,void 0,void 0,(function(){var e,r,i,s,a;return o(this,(function(o){switch(o.label){case 0:if(e=h.config.requestTotalAttempts,r=!1,s=0,!this.currentNodes.length)throw new Error("No nodes to query, probably need to call bootstrap()");o.label=1;case 1:if(r)return[3,11];s++,n.baseURL="".concat(this.currentNodes[this.nodeIndex].address,"/api").concat(t),o.label=2;case 2:return o.trys.push([2,4,,10]),[4,c.default.request(n)];case 3:return i=o.sent(),r=!0,[3,10];case 4:return void 0!==(a=o.sent()).response?[3,8]:s<e?[4,this.incrementNodeIndex()]:[3,6];case 5:return o.sent(),[3,7];case 6:throw new Error("Too many attempts.");case 7:return[3,9];case 8:throw new Error(a.response.data.msg);case 9:return[3,10];case 10:return[3,1];case 11:return[2,i.data]}}))}))},this.currentChain=t}return t.prototype.sendTxAndWaitForResponse=function(t,e){return void 0===e&&(e=120),r(this,void 0,void 0,(function(){var n=this;return o(this,(function(r){return[2,new Promise((function(r,o){n.sendPreparedTX(t,(function(t,e){return t?r(e):o(e)}),e)}))]}))}))},t.prototype.getFeeSettings=function(){return r(this,void 0,void 0,(function(){var t;return o(this,(function(e){switch(e.label){case 0:return[4,this.askBlockchainTo(p.ChainAction.GET_NODE_SETTINGS,{})];case 1:return t=e.sent(),[2,this.calculateFeeSettings(t)]}}))}))},t.prototype.getChain=function(){return this.currentChain},t.prototype.getChainInfo=function(){return r(this,void 0,void 0,(function(){return o(this,(function(t){return[2,Promise.resolve(h.chainConfig)]}))}))},t.prototype.loadRemoteSCInterface=function(t){return r(this,void 0,void 0,(function(){var e,n,r,s,h,u,p,d,f;return o(this,(function(o){switch(o.label){case 0:return e=i(t,2),n=e[0],r=e[1],s=i(n.split(":"),2),h=s[0],u=s[1],p=r.includes("ipfs")?"https://ipfs.io/ipfs/".concat(r.split("://")[1]):r+"?".concat(+new Date),[4,c.default.request({baseURL:p,responseType:"arraybuffer"})];case 1:if(d=o.sent().data,f=new Uint8Array(d),(0,a.default)(h).update(f).digest().toString("hex")!==u)throw new Error("Hash mismatch");return[2,f]}}))}))},t.prototype.sendPreparedTX=function(t,e,n){return r(this,void 0,void 0,(function(){var r,i=this;return o(this,(function(o){switch(o.label){case 0:return[4,this.askBlockchainTo(p.ChainAction.CREATE_TRANSACTION,{data:{tx:t}})];case 1:return r=o.sent(),e&&setTimeout((function(){return i.checkTransaction(r.txid,e,n)}),h.config.callbackCallDelay),[2,r]}}))}))},t.prototype.calculateFeeSettings=function(t){var e;if(!(t=t.current).fee)return{};if((t=t.fee).SK)e="SK";else{if(!t.FEE)return{};e="FEE"}return{feeCur:e,fee:t[e].base,baseEx:t[e].baseextra,kb:t[e].kb}},t.prototype.checkResponseValidity=function(t){if(!(t instanceof ArrayBuffer||t instanceof Buffer||t.ok))throw t.msg?new Error("(".concat(t.code,") ").concat(t.msg)):new Error("Incorrect response (".concat(t.code,")"))},t.prototype.getAddressChain=function(t){return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,this.askBlockchainTo(p.ChainAction.GET_MY_CHAIN,{address:t})];case 1:return[2,e.sent().chain]}}))}))},t.prototype.askBlockchainTo=function(t,e){return r(this,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){switch(o.label){case 0:switch(r={timeout:h.config.chainRequestTimeout,method:"get"},t){case p.ChainAction.GET_BLOCK:n="/block",r.url=e.hash;break;case p.ChainAction.GET_WALLET:n="/address",r.url=e.address;break;case p.ChainAction.CREATE_TRANSACTION:n="/tx/new",r.method="post",r.data=e.data;break;case p.ChainAction.GET_TRANSACTION_STATUS:n="/tx/status",r.url=e.txId;break;case p.ChainAction.GET_MY_CHAIN:n="/where",r.url=e.address;break;case p.ChainAction.GET_CHAIN_NODES:n="/nodes",r.url=e.remoteChain.toString();break;case p.ChainAction.GET_NODE_SETTINGS:n="/settings";break;case p.ChainAction.GET_SC_CODE:r.responseType="arraybuffer",r.url=e.address+"/code",n="/address";break;case p.ChainAction.GET_SC_STATE:r.responseType="arraybuffer",r.url=e.address+"/state",n="/address";break;default:throw new Error("Unknown action")}return[4,this.httpRequest(n,r)];case 1:return i=o.sent(),this.checkResponseValidity(i),[2,i=(0,u.transformResponse)(i,t)]}}))}))},t}();e.Network=f},167:t=>{t.exports=require("axios")},999:t=>{t.exports=require("create-hash")},974:t=>{t.exports=require("debug")}},e={};new(function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}(115).Network)("102").bootstrap().then((function(){console.log("ok")}))})();